<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä SVG –î—Ä–æ–±–µ–π</title>
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f4f4f4;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: #333;
        }

        .generator-app {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            display: flex;
            gap: 50px;
            align-items: flex-start;
        }

        /* –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–°–ª–µ–≤–∞) */
        .controls {
            width: 250px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        h2 { margin: 0 0 10px 0; font-size: 20px; }
        label { font-size: 14px; font-weight: bold; margin-bottom: 5px; display: block; }

        input[type="number"], select {
            width: 100%;
            padding: 10px;
            font-size: 16px;
            border: 2px solid #ddd;
            border-radius: 8px;
            box-sizing: border-box; /* –ß—Ç–æ–±—ã padding –Ω–µ –ª–æ–º–∞–ª —à–∏—Ä–∏–Ω—É */
        }

        input[type="color"] {
            width: 100%;
            height: 50px;
            border: none;
            cursor: pointer;
            background: none;
        }

        .btn-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }

        button {
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: opacity 0.2s;
            font-size: 14px;
        }

        .btn-update { background: #333; color: white; }
        .btn-download { background: #1EB159; color: white; display: flex; align-items: center; justify-content: center; gap: 8px; }
        
        button:hover { opacity: 0.9; }

        /* –û–±–ª–∞—Å—Ç—å –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ (–°–ø—Ä–∞–≤–∞) */
        .preview-area {
            display: flex;
            gap: 30px;
            background: #E8E8E8;
            padding: 30px;
            border-radius: 16px;
            align-items: center;
        }

        .svg-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .label-tag {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        svg {
            background: transparent; /* –í–∞–∂–Ω–æ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –±–µ–∑ —Ñ–æ–Ω–∞ */
            display: block;
        }

        /* –¢–µ–Ω—å —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–µ–≤—å—é –Ω–∞ —Å–∞–π—Ç–µ, –≤ —Ñ–∞–π–ª–µ –µ—ë –Ω–µ –±—É–¥–µ—Ç */
        .preview-shadow {
            filter: drop-shadow(0px 4px 6px rgba(0,0,0,0.1)); 
        }

    </style>
</head>
<body>

<div class="generator-app">
    
    <div class="controls">
        <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
        
        <div>
            <label>–ß–∏—Å–ª–∏—Ç–µ–ª—å (–ß–∞—Å—Ç–∏)</label>
            <input type="number" id="inp-num" value="3" min="0">
        </div>

        <div>
            <label>–ó–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å (–í—Å–µ–≥–æ)</label>
            <input type="number" id="inp-denom" value="5" min="1">
        </div>

        <div>
            <label>–¶–≤–µ—Ç –∑–∞–ª–∏–≤–∫–∏</label>
            <input type="color" id="inp-color" value="#FF5555">
        </div>

        <button class="btn-update" onclick="updateVisuals()">–û–±–Ω–æ–≤–∏—Ç—å –≤–∏–¥</button>

        <div class="btn-group">
            <button class="btn-download" onclick="downloadSVG('svg-circle', 'pie_chart')">
                üíæ –°–∫–∞—á–∞—Ç—å –ö—Ä—É–≥
            </button>
            <button class="btn-download" onclick="downloadSVG('svg-fraction', 'fraction_text')">
                üíæ –°–∫–∞—á–∞—Ç—å –¶–∏—Ñ—Ä—ã
            </button>
        </div>
    </div>

    <div class="preview-area">
        
        <div class="svg-container">
            <span class="label-tag">–ö—Ä—É–≥</span>
            <svg id="svg-circle" width="200" height="200" viewBox="0 0 200 200" class="preview-shadow" xmlns="http://www.w3.org/2000/svg"></svg>
        </div>

        <div class="svg-container">
            <span class="label-tag">–î—Ä–æ–±—å</span>
            <svg id="svg-fraction" width="100" height="160" viewBox="0 0 100 160" class="preview-shadow" xmlns="http://www.w3.org/2000/svg"></svg>
        </div>

    </div>

</div>

<script>
    // --- –≠–õ–ï–ú–ï–ù–¢–´ ---
    const inpNum = document.getElementById('inp-num');
    const inpDenom = document.getElementById('inp-denom');
    const inpColor = document.getElementById('inp-color');
    const svgCircle = document.getElementById('svg-circle');
    const svgFraction = document.getElementById('svg-fraction');

    // --- –û–°–ù–û–í–ù–ê–Ø –õ–û–ì–ò–ö–ê ---

    function updateVisuals() {
        const num = parseInt(inpNum.value) || 0;
        const total = parseInt(inpDenom.value) || 1;
        const color = inpColor.value;

        // –†–∏—Å—É–µ–º –æ–±–∞ —ç–ª–µ–º–µ–Ω—Ç–∞
        drawPieChart(num, total, color);
        drawFractionText(num, total);
    }

    // 1. –†–∏—Å—É–µ–º –ö—Ä—É–≥ (–ü–∏—Ä–æ–≥)
    function drawPieChart(num, total, fillColor) {
        svgCircle.innerHTML = ''; // –û—á–∏—Å—Ç–∫–∞

        const cx = 100;
        const cy = 100;
        const radius = 90;
        const strokeColor = "#000000";

        for (let i = 0; i < total; i++) {
            // –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ —É–≥–ª–æ–≤ (–Ω–∞—á–∞–ª–æ —Å–≤–µ—Ä—Ö—É, -90deg)
            const startAngle = (i * 2 * Math.PI) / total - Math.PI / 2;
            const endAngle = ((i + 1) * 2 * Math.PI) / total - Math.PI / 2;

            const x1 = cx + radius * Math.cos(startAngle);
            const y1 = cy + radius * Math.sin(startAngle);
            const x2 = cx + radius * Math.cos(endAngle);
            const y2 = cy + radius * Math.sin(endAngle);

            // Path –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç–∞
            const d = `M ${cx} ${cy} L ${x1} ${y1} A ${radius} ${radius} 0 0 1 ${x2} ${y2} Z`;

            const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
            path.setAttribute("d", d);
            path.setAttribute("stroke", strokeColor);
            path.setAttribute("stroke-width", "2");

            // –ó–∞–ª–∏–≤–∫–∞ –ø–æ–¥—Ä—è–¥
            if (i < num) {
                path.setAttribute("fill", fillColor);
            } else {
                path.setAttribute("fill", "#FFFFFF"); // –ë–µ–ª—ã–π —Ñ–æ–Ω –¥–ª—è –ø—É—Å—Ç—ã—Ö (–∏–ª–∏ transparent)
            }

            svgCircle.appendChild(path);
        }
    }

    // 2. –†–∏—Å—É–µ–º –î—Ä–æ–±—å (–¶–∏—Ñ—Ä—ã –∏ –ª–∏–Ω–∏—è)
    function drawFractionText(num, total) {
        svgFraction.innerHTML = ''; // –û—á–∏—Å—Ç–∫–∞

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —à—Ä–∏—Ñ—Ç–∞
        const fontSize = "60";
        const fontFamily = "sans-serif"; // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —à—Ä–∏—Ñ—Ç –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
        const fontWeight = "bold";
        const color = "#000000";

        // 1. –ß–∏—Å–ª–∏—Ç–µ–ª—å (—Å–≤–µ—Ä—Ö—É)
        const textNum = document.createElementNS("http://www.w3.org/2000/svg", "text");
        textNum.setAttribute("x", "50"); // –¶–µ–Ω—Ç—Ä –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ (–ø–æ–ª–æ–≤–∏–Ω–∞ –æ—Ç 100)
        textNum.setAttribute("y", "55"); // –ü–æ–∑–∏—Ü–∏—è –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏
        textNum.setAttribute("text-anchor", "middle"); // –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –ø–æ —Ü–µ–Ω—Ç—Ä—É
        textNum.setAttribute("font-family", fontFamily);
        textNum.setAttribute("font-size", fontSize);
        textNum.setAttribute("font-weight", fontWeight);
        textNum.setAttribute("fill", color);
        textNum.textContent = num;

        // 2. –õ–∏–Ω–∏—è –¥—Ä–æ–±–∏ (–ø–æ—Å–µ—Ä–µ–¥–∏–Ω–µ)
        const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
        line.setAttribute("x1", "10");
        line.setAttribute("y1", "80"); // –°–µ—Ä–µ–¥–∏–Ω–∞ –≤—ã—Å–æ—Ç—ã (160/2)
        line.setAttribute("x2", "90");
        line.setAttribute("y2", "80");
        line.setAttribute("stroke", color);
        line.setAttribute("stroke-width", "4");
        line.setAttribute("stroke-linecap", "round"); // –°–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–µ –∫—Ä–∞—è –ª–∏–Ω–∏–∏

        // 3. –ó–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å (—Å–Ω–∏–∑—É)
        const textDenom = document.createElementNS("http://www.w3.org/2000/svg", "text");
        textDenom.setAttribute("x", "50");
        textDenom.setAttribute("y", "145");
        textDenom.setAttribute("text-anchor", "middle");
        textDenom.setAttribute("font-family", fontFamily);
        textDenom.setAttribute("font-size", fontSize);
        textDenom.setAttribute("font-weight", fontWeight);
        textDenom.setAttribute("fill", color);
        textDenom.textContent = total;

        // –î–æ–±–∞–≤–ª—è–µ–º –≤ SVG
        svgFraction.appendChild(textNum);
        svgFraction.appendChild(line);
        svgFraction.appendChild(textDenom);
    }

    // --- –§–£–ù–ö–¶–ò–Ø –°–ö–ê–ß–ò–í–ê–ù–ò–Ø ---
    function downloadSVG(elementId, fileNameBase) {
        const svgElement = document.getElementById(elementId);
        
        // –°–µ—Ä–∏–∞–ª–∏–∑—É–µ–º DOM —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ —Å—Ç—Ä–æ–∫—É
        const serializer = new XMLSerializer();
        let source = serializer.serializeToString(svgElement);

        // –î–æ–±–∞–≤–ª—è–µ–º namespace, –µ—Å–ª–∏ –≤–¥—Ä—É–≥ –±—Ä–∞—É–∑–µ—Ä –Ω–µ –¥–æ–±–∞–≤–∏–ª (–Ω—É–∂–Ω–æ –¥–ª—è –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ —Ñ–∞–π–ª–∞)
        if(!source.match(/^<svg[^>]+xmlns="http\:\/\/www\.w3\.org\/2000\/svg"/)){
            source = source.replace(/^<svg/, '<svg xmlns="http://www.w3.org/2000/svg"');
        }

        // –£–±–∏—Ä–∞–µ–º —Ç–µ–Ω—å (–∫–ª–∞—Å—Å preview-shadow), —á—Ç–æ–±—ã –µ—ë –Ω–µ –±—ã–ª–æ –≤ —Ñ–∞–π–ª–µ
        // (—Ö–æ—Ç—è SVG —Å—Ç–∏–ª–∏ classes –º–æ–≥—É—Ç –Ω–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è, –ª—É—á—à–µ –±—ã—Ç—å —É–≤–µ—Ä–µ–Ω–Ω—ã–º)
        source = source.replace('class="preview-shadow"', '');

        // –°–æ–∑–¥–∞–µ–º Blob (—Ñ–∞–π–ª –≤ –ø–∞–º—è—Ç–∏)
        const blob = new Blob([source], {type: "image/svg+xml;charset=utf-8"});
        const url = URL.createObjectURL(blob);

        // –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é —Å—Å—ã–ª–∫—É –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
        const link = document.createElement("a");
        link.href = url;
        
        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∏–º—è —Ñ–∞–π–ª–∞: –Ω–∞–ø—Ä–∏–º–µ—Ä pie_chart_3_5.svg
        const num = inpNum.value;
        const den = inpDenom.value;
        link.download = `${fileNameBase}_${num}_${den}.svg`;
        
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }

    // –°–ª—É—à–∞—Ç–µ–ª–∏ —Å–æ–±—ã—Ç–∏–π (—á—Ç–æ–±—ã –æ–±–Ω–æ–≤–ª—è–ª–æ—Å—å –ø—Ä–∏ –≤–≤–æ–¥–µ)
    inpNum.addEventListener('input', updateVisuals);
    inpDenom.addEventListener('input', updateVisuals);
    inpColor.addEventListener('input', updateVisuals);

    // –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
    updateVisuals();

</script>

</body>
</html>